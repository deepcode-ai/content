id: nexpose_test
version: 19
vcShouldKeepItemLegacyProdMachine: false
name: Nexpose Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 25bf3b0f-30cd-4dbd-83c2-36c16fbcd22c
    type: start
    task:
      id: 25bf3b0f-30cd-4dbd-83c2-36c16fbcd22c
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 0e0701ec-45c2-43bd-86d5-82127f851bcb
    type: regular
    task:
      id: 0e0701ec-45c2-43bd-86d5-82127f851bcb
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: bb399217-ff22-49ea-8911-4c0c6cbced47
    type: regular
    task:
      id: bb399217-ff22-49ea-8911-4c0c6cbced47
      version: -1
      name: nexpose-create-asset
      description: Create a new asset.
      script: Rapid7 Nexpose|||nexpose-create-asset
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      date:
        complex:
          root: TimeNow
      ip:
        complex:
          root: inputs.fake_asset_ip
      site_id:
        complex:
          root: Nexpose.Site
          accessor: Id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 4422e890-e790-4b07-8de0-194e79a4cd7d
    type: regular
    task:
      id: 4422e890-e790-4b07-8de0-194e79a4cd7d
      version: -1
      name: nexpose-get-sites
      description: Retrieves accessible sites.
      script: Rapid7 Nexpose|||nexpose-get-sites
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: f664f5ab-eb0f-4c8b-8fab-55e3819da74f
    type: regular
    task:
      id: f664f5ab-eb0f-4c8b-8fab-55e3819da74f
      version: -1
      name: nexpose-search-assets
      description: Search all assets matching filters (with Returns all assets for
        which you have access that match the given search criteria.
      script: Rapid7 Nexpose|||nexpose-search-assets
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      limit:
        simple: "1"
      riskScoreHigherThan:
        simple: "10000"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 1d59426c-b466-4fa6-8b7b-2462ff628b85
    type: regular
    task:
      id: 1d59426c-b466-4fa6-8b7b-2462ff628b85
      version: -1
      name: nexpose-get-asset
      description: Returns the specified asset.
      script: Rapid7 Nexpose|||nexpose-get-asset
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      id:
        complex:
          root: Nexpose.Asset
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 2d41b2df-b0e7-49bf-852a-61e8787d1cb5
    type: regular
    task:
      id: 2d41b2df-b0e7-49bf-852a-61e8787d1cb5
      version: -1
      name: nexpose-delete-asset
      description: Delete an asset.
      script: Rapid7 Nexpose|||nexpose-delete-asset
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      id:
        complex:
          root: Nexpose.Asset
          accessor: AssetId
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 62a82fd9-52f4-4820-8b39-057aa2f40bf9
    type: regular
    task:
      id: 62a82fd9-52f4-4820-8b39-057aa2f40bf9
      version: -1
      name: nexpose-get-scan
      description: Get a specific scan.
      script: Rapid7 Nexpose|||nexpose-get-scan
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      id:
        complex:
          root: Nexpose.Scan
          accessor: Id
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 97c3039b-0db2-43f7-8854-12a369449bea
    type: regular
    task:
      id: 97c3039b-0db2-43f7-8854-12a369449bea
      version: -1
      name: nexpose-create-scan-report
      description: Generates a new report for a specified scan.
      script: Rapid7 Nexpose|||nexpose-create-scan-report
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      scan:
        complex:
          root: Nexpose.Scan
          accessor: Id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: c8971e3a-8ee0-4ee1-882a-b2541d4a9030
    type: regular
    task:
      id: c8971e3a-8ee0-4ee1-882a-b2541d4a9030
      version: -1
      name: nexpose-create-assets-report
      description: Generates a new report on given assets according to a template
        and arguments.
      script: Rapid7 Nexpose|||nexpose-create-assets-report
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      assets:
        complex:
          root: Nexpose.Asset
          accessor: AssetId
      download_immediately:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: ed5045a3-63d7-489f-8079-797ab724e43a
    type: regular
    task:
      id: ed5045a3-63d7-489f-8079-797ab724e43a
      version: -1
      name: nexpose-create-sites-report
      description: Generates a new report on given sites according to a template and
        arguments.
      script: Rapid7 Nexpose|||nexpose-create-sites-report
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      sites:
        complex:
          root: Nexpose.Site
          accessor: Id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 05a96b96-b8f9-4b32-8472-9fa0ebd3f336
    type: regular
    task:
      id: 05a96b96-b8f9-4b32-8472-9fa0ebd3f336
      version: -1
      name: nexpose-get-assets
      description: Returns all assets for which you have access.
      script: Rapid7 Nexpose|||nexpose-get-assets
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: c74631e9-cbfd-409a-81fe-24a02fb8afd6
    type: regular
    task:
      id: c74631e9-cbfd-409a-81fe-24a02fb8afd6
      version: -1
      name: nexpose-create-vulnerability-exception
      description: Create a new vulnerability exception.
      script: Rapid7 Nexpose|||nexpose-create-vulnerability-exception
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      reason:
        simple: Acceptable Use
      scope_id:
        complex:
          root: Nexpose.Asset
          accessor: id
      scope_type:
        simple: Asset
      state:
        simple: Under Review
      vulnerability_id:
        complex:
          root: inputs.vulenrability_id_to_except
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: d3e9915e-f513-4323-855f-de10ec80b755
    type: regular
    task:
      id: d3e9915e-f513-4323-855f-de10ec80b755
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: eb10bb25-89ee-4413-8f1e-671429f7350f
    type: regular
    task:
      id: eb10bb25-89ee-4413-8f1e-671429f7350f
      version: -1
      name: nexpose-delete-vulnerability-exception
      description: Delete a vulnerability exception.
      script: Rapid7 Nexpose|||nexpose-delete-vulnerability-exception
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      id:
        complex:
          root: Nexpose.VulnerabilityException
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: c826d7f1-6311-4107-890c-144afde93082
    type: regular
    task:
      id: c826d7f1-6311-4107-890c-144afde93082
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "73"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 2c209678-0720-4765-8ddf-83d1b38cd1b9
    type: regular
    task:
      id: 2c209678-0720-4765-8ddf-83d1b38cd1b9
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: d2ff0f1f-e119-413b-8dbf-fddea657c513
    type: regular
    task:
      id: d2ff0f1f-e119-413b-8dbf-fddea657c513
      version: -1
      name: nexpose-create-shared-credential
      description: 'Create a new shared credential. For detailed explanation of all
        parameters of this command, please see: https://help.rapid7.com/insightvm/en-us/api/index.html#operation/createSharedCredential'
      script: Rapid7 Nexpose|||nexpose-create-shared-credential
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      name:
        simple: Test-Credential
      password:
        simple: test
      service:
        simple: FTP
      site_assignment:
        simple: Specific-Sites
      sites:
        complex:
          root: Nexpose.Site
          accessor: Id
      username:
        simple: test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: cf6be6d8-d430-42aa-8b45-68e9ba010d32
    type: regular
    task:
      id: cf6be6d8-d430-42aa-8b45-68e9ba010d32
      version: -1
      name: nexpose-list-shared-credential (specific ID)
      description: Retrieve information about all or a specific shared credential.
      script: Rapid7 Nexpose|||nexpose-list-shared-credential
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      id:
        complex:
          root: Nexpose.SharedCredential
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: b895acba-2729-4423-8a66-af28140f0208
    type: regular
    task:
      id: b895acba-2729-4423-8a66-af28140f0208
      version: -1
      name: nexpose-delete-shared-credential
      description: |-
        Beta Command

         Delete a shared credential.
      script: Rapid7 Nexpose|||nexpose-delete-shared-credential
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      id:
        complex:
          root: Nexpose.SharedCredential
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: ecd4bca1-159b-4c7d-88de-d2979bd79a29
    type: regular
    task:
      id: ecd4bca1-159b-4c7d-88de-d2979bd79a29
      version: -1
      name: nexpose-get-asset-vulnerability
      description: Returns details and possible remediations for an asset's vulnerability.
      script: Rapid7 Nexpose|||nexpose-get-asset-vulnerability
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      id:
        simple: ${Nexpose.Asset.AssetId}
      vulnerabilityId:
        simple: ${Nexpose.Vulnerability.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 3dd7046a-0ca6-4a5f-8d45-c6c99c422f90
    type: regular
    task:
      id: 3dd7046a-0ca6-4a5f-8d45-c6c99c422f90
      version: -1
      name: nexpose-list-vulnerability (specific ID)
      description: Retrieve information about all or a specific vulnerability.
      script: Rapid7 Nexpose|||nexpose-list-vulnerability
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      id:
        simple: ${Nexpose.Vulnerability.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 1d3a634e-7529-4d01-8bfe-3f0fa916eeba
    type: regular
    task:
      id: 1d3a634e-7529-4d01-8bfe-3f0fa916eeba
      version: -1
      name: nexpose-update-shared-credential
      description: Update an existing shared credential.
      script: Rapid7 Nexpose|||nexpose-update-shared-credential
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      id:
        complex:
          root: Nexpose.SharedCredential
          accessor: id
      name:
        simple: Test Credential
      password:
        simple: New Password
      service:
        simple: FTP
      site_assignment:
        simple: All-Sites
      username:
        simple: New Username
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: d098b04e-41a5-4b35-80fa-8a7c27e46579
    type: regular
    task:
      id: d098b04e-41a5-4b35-80fa-8a7c27e46579
      version: -1
      name: nexpose-update-vulnerability-exception-expiration
      description: Update an existing vulnerability exception.
      script: Rapid7 Nexpose|||nexpose-update-vulnerability-exception-expiration
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      expiration:
        complex:
          root: TimeNow
      id:
        complex:
          root: Nexpose.VulnerabilityException
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 90008958-055d-4a77-825b-96d4a823e1bc
    type: regular
    task:
      id: 90008958-055d-4a77-825b-96d4a823e1bc
      version: -1
      name: nexpose-update-vulnerability-exception-status
      description: Update an existing vulnerability exception.
      script: Rapid7 Nexpose|||nexpose-update-vulnerability-exception-status
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      id:
        complex:
          root: Nexpose.VulnerabilityException
          accessor: id
      status:
        simple: Reject
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 16054687-4fa8-4ec7-83d8-dfc3bfa628fd
    type: regular
    task:
      id: 16054687-4fa8-4ec7-83d8-dfc3bfa628fd
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 691b1615-f5dd-4db3-85dc-c57edaa346a5
    type: regular
    task:
      id: 691b1615-f5dd-4db3-85dc-c57edaa346a5
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 7aba09f2-b155-4662-8595-3d9d289d2c3f
    type: regular
    task:
      id: 7aba09f2-b155-4662-8595-3d9d289d2c3f
      version: -1
      name: nexpose-download-report
      description: Returns the generated report.
      script: Rapid7 Nexpose|||nexpose-download-report
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      instance_id:
        complex:
          root: Nexpose.Report
          accessor: InstanceID
      report_id:
        complex:
          root: Nexpose.Report
          accessor: ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: ed9d0cb9-8c28-46f6-8940-d8b2ca7e6b44
    type: title
    task:
      id: ed9d0cb9-8c28-46f6-8940-d8b2ca7e6b44
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: f37d0ae2-fb53-4ac5-89ce-38d41da007d2
    type: regular
    task:
      id: f37d0ae2-fb53-4ac5-89ce-38d41da007d2
      version: -1
      name: nexpose-get-asset-tags
      description: Returns the specified tags for an asset.
      script: Rapid7 Nexpose|||nexpose-get-asset-tags
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      asset_id:
        complex:
          root: Nexpose.Asset
          accessor: id
      id:
        complex:
          root: Nexpose.Asset
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 3603a4fe-4ae8-4034-8182-016d7fcbb216
    type: regular
    task:
      id: 3603a4fe-4ae8-4034-8182-016d7fcbb216
      version: -1
      name: nexpose-get-sites
      description: Retrieves accessible sites.
      script: Rapid7 Nexpose|||nexpose-get-sites
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 12a77f10-b465-48a4-8f2f-241feb75b5cb
    type: regular
    task:
      id: 12a77f10-b465-48a4-8f2f-241feb75b5cb
      version: -1
      name: nexpose-get-scans
      description: Return a list of scans. Returns only active scans by default (active=true).
      script: Rapid7 Nexpose|||nexpose-get-scans
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      active:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 15c167cf-b1fa-4aa0-8774-d1cd903bc3b9
    type: regular
    task:
      id: 15c167cf-b1fa-4aa0-8774-d1cd903bc3b9
      version: -1
      name: nexpose-get-sites
      description: Retrieves accessible sites.
      script: Rapid7 Nexpose|||nexpose-get-sites
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 6809c51a-05c5-4fd7-8f60-3797698147a9
    type: regular
    task:
      id: 6809c51a-05c5-4fd7-8f60-3797698147a9
      version: -1
      name: nexpose-list-shared-credential
      description: Retrieve information about all or a specific shared credential.
      script: Rapid7 Nexpose|||nexpose-list-shared-credential
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "25"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: ac4deba3-2467-49b0-87c8-2d05044d8d3a
    type: regular
    task:
      id: ac4deba3-2467-49b0-87c8-2d05044d8d3a
      version: -1
      name: nexpose-list-vulnerability
      description: Retrieve information about all or a specific vulnerability.
      script: Rapid7 Nexpose|||nexpose-list-vulnerability
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: aa73bae1-1ac2-4d68-84ff-7e9b7152d7cb
    type: condition
    task:
      id: aa73bae1-1ac2-4d68-84ff-7e9b7152d7cb
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.Site.Id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 9d53639a-d6f9-4704-8c83-762c62319a06
    type: condition
    task:
      id: 9d53639a-d6f9-4704-8c83-762c62319a06
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.Site.Id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 012de680-f467-4d22-8470-38c99431df80
    type: condition
    task:
      id: 012de680-f467-4d22-8470-38c99431df80
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.Site.Id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: ccf99b9c-cdd4-4de3-8a57-511ae330b790
    type: regular
    task:
      id: ccf99b9c-cdd4-4de3-8a57-511ae330b790
      version: -1
      name: GetTime
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      dateFormat:
        simple: ISO
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: a328a588-3a54-4090-81d3-d3bc34049d94
    type: regular
    task:
      id: a328a588-3a54-4090-81d3-d3bc34049d94
      version: -1
      name: GetTime (+1 year)
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      dateFormat:
        simple: ISO
      yearsAgo:
        simple: "-1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: fd48b6b1-18c5-48c2-8a9a-bf3039f3edf5
    type: regular
    task:
      id: fd48b6b1-18c5-48c2-8a9a-bf3039f3edf5
      version: -1
      name: nexpose-list-vulnerability-exceptions
      description: Retrieve information about scan schedules for a specific site or
        a specific scan schedule.
      script: Rapid7 Nexpose|||nexpose-list-vulnerability-exceptions
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      limit:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 1237f055-744d-4bac-8e9d-00ae64fb8ff7
    type: regular
    task:
      id: 1237f055-744d-4bac-8e9d-00ae64fb8ff7
      version: -1
      name: nexpose-delete-vulnerability-exception
      description: Delete a vulnerability exception.
      script: Rapid7 Nexpose|||nexpose-delete-vulnerability-exception
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      id:
        complex:
          root: Nexpose.VulnerabilityException
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Nexpose.VulnerabilityException.scope.vulnerability
                iscontext: true
              right:
                value:
                  simple: inputs.vulenrability_id_to_except
                iscontext: true
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 9b9f1f43-99ec-4663-8e7f-08d6ebd3a418
    type: condition
    task:
      id: 9b9f1f43-99ec-4663-8e7f-08d6ebd3a418
      version: -1
      name: If Vulnerability Already Has An Exception
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "49"
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: in
          left:
            value:
              simple: inputs.vulenrability_id_to_except
            iscontext: true
          right:
            value:
              complex:
                root: Nexpose.VulnerabilityException.scope
                accessor: vulnerability
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: e15f251c-9087-4dfb-8bf6-2aa6f0271c70
    type: regular
    task:
      id: e15f251c-9087-4dfb-8bf6-2aa6f0271c70
      version: -1
      name: DeleteContext (Nexpose.VulnerabilityException)
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      key:
        simple: Nexpose.VulnerabilityException
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 1a4f625f-0e0c-41a3-848f-1036fa3309fa
    type: regular
    task:
      id: 1a4f625f-0e0c-41a3-848f-1036fa3309fa
      version: -1
      name: nexpose-create-tag
      description: Create a tag.
      script: '|||nexpose-create-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      color:
        simple: Green
      ip_address_is:
        simple: 1.1.1.1
      name:
        simple: testplaybook
      type:
        simple: Custom
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: ffdcd278-73d4-4e33-859e-59c3216faed6
    type: regular
    task:
      id: ffdcd278-73d4-4e33-859e-59c3216faed6
      version: -1
      name: nexpose-delete-tag
      description: Delete a tag.
      script: '|||nexpose-delete-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 0fdd1010-70c9-484d-8b73-a9950d34e815
    type: regular
    task:
      id: 0fdd1010-70c9-484d-8b73-a9950d34e815
      version: -1
      name: Nexpose.update-tag-search-carteria
      description: Update tag search criteria.
      script: '|||nexpose-update-tag-search-criteria'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      risk_score_higher_than:
        simple: "8000"
      tag_id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: fd472775-d906-452f-8b43-5b6e41c3ce7c
    type: condition
    task:
      id: fd472775-d906-452f-8b43-5b6e41c3ce7c
      version: -1
      name: check tag search filters
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Nexpose.Tag.searchCriteria.filters.field
            iscontext: true
          right:
            value:
              simple: ip-address
      - - operator: isEqualString
          left:
            value:
              simple: Nexpose.Tag.searchCriteria.filters.field
            iscontext: true
          right:
            value:
              simple: risk-score
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: f9e6a297-5c86-4da8-84e4-4e34ec0e6ade
    type: regular
    task:
      id: f9e6a297-5c86-4da8-84e4-4e34ec0e6ade
      version: -1
      name: nexpose-list-tag
      description: Return a list of tags.
      script: '|||nexpose-list-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 9f2fc038-2641-4cf1-87dc-14179b8d0798
    type: regular
    task:
      id: 9f2fc038-2641-4cf1-87dc-14179b8d0798
      version: -1
      name: nexpose-list-tag-asset-group
      description: Return a list of asset groups for a tag.
      script: '|||nexpose-list-tag-asset-group'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      tag_id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 17b877db-9dc8-4cfb-8893-686d51010e88
    type: regular
    task:
      id: 17b877db-9dc8-4cfb-8893-686d51010e88
      version: -1
      name: nexpose-list-tag-asset
      description: Return a list of assets for a tag.
      script: '|||nexpose-list-tag-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      tag_id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 3ebb218e-109e-48fa-81e7-d48a728b2277
    type: regular
    task:
      id: 3ebb218e-109e-48fa-81e7-d48a728b2277
      version: -1
      name: nexpose-add-tag-asset
      description: Add an existing asset to an existing tag.
      script: '|||nexpose-add-tag-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      asset_id:
        simple: ${Nexpose.Asset.AssetId}
      tag_id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: dc22be3f-27a6-45a7-8f1c-d852efef61a4
    type: regular
    task:
      id: dc22be3f-27a6-45a7-8f1c-d852efef61a4
      version: -1
      name: nexpose-get-assets
      description: Returns all assets for which you have access.
      script: '|||nexpose-get-assets'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: fa6c139d-8e4a-4833-8be7-6d8a88fefa73
    type: condition
    task:
      id: fa6c139d-8e4a-4833-8be7-6d8a88fefa73
      version: -1
      name: check tag assets not empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "60"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.TagAsset
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 1aece61e-1c77-471d-8da1-9ec531aa726f
    type: regular
    task:
      id: 1aece61e-1c77-471d-8da1-9ec531aa726f
      version: -1
      name: nexpose-remove-tag-asset
      description: Remove an asset from a tag. Please note that the asset must be
        added through the asset or tag. If the asset is added using a site, asset
        group, or search criteria, this action will not remove the asset from the
        tag.
      script: '|||nexpose-remove-tag-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      asset_id:
        simple: ${Nexpose.Asset.AssetId}
      tag_id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 59e5acd8-c7ca-49de-86af-d24630cd2870
    type: regular
    task:
      id: 59e5acd8-c7ca-49de-86af-d24630cd2870
      version: -1
      name: nexpose-add-site-included-asset
      description: Add included assets to a site.
      script: '|||nexpose-add-site-included-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      assets:
        simple: 8.8.8.8
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: d866b1fa-392b-4f7d-840a-0462edc48931
    type: regular
    task:
      id: d866b1fa-392b-4f7d-840a-0462edc48931
      version: -1
      name: nexpose-get-sites
      description: Retrieves accessible sites.
      script: '|||nexpose-get-sites'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: b491d1db-80e3-4dd3-840f-8079618074f2
    type: regular
    task:
      id: b491d1db-80e3-4dd3-840f-8079618074f2
      version: -1
      name: nexpose-list-site-included-asset
      description: Return a list of included assets for a site.
      script: '|||nexpose-list-site-included-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "68"
    scriptarguments:
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 1cafe855-44e1-438b-86c7-97555cb34275
    type: regular
    task:
      id: 1cafe855-44e1-438b-86c7-97555cb34275
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "74"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 471b3491-23ce-45fc-8aae-ba1afb3c3c07
    type: regular
    task:
      id: 471b3491-23ce-45fc-8aae-ba1afb3c3c07
      version: -1
      name: nexpose-remove-site-included-asset
      description: Remove included assets from a site.
      script: '|||nexpose-remove-site-included-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      assets:
        simple: 8.8.8.8
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: 26d5559d-e50b-4ab5-8bcb-0eab8e0fb2d0
    type: condition
    task:
      id: 26d5559d-e50b-4ab5-8bcb-0eab8e0fb2d0
      version: -1
      name: check site included assets not empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.IncludedAsset.addresses
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: afbd8b1a-f78a-484b-89d2-c39f4022f93a
    type: regular
    task:
      id: afbd8b1a-f78a-484b-89d2-c39f4022f93a
      version: -1
      name: nexpose-add-site-excluded-asset
      description: Add excluded assets to a site.
      script: '|||nexpose-add-site-excluded-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      assets:
        simple: 8.8.8.8
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 1cb66db7-066d-4799-8e53-c79a39eb3444
    type: regular
    task:
      id: 1cb66db7-066d-4799-8e53-c79a39eb3444
      version: -1
      name: nexpose-list-site-excluded-asset
      description: Return a list of excluded assets for a site.
      script: '|||nexpose-list-site-excluded-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: d156bf04-fe85-4345-82a2-5a4f624cd146
    type: condition
    task:
      id: d156bf04-fe85-4345-82a2-5a4f624cd146
      version: -1
      name: check site excluded assets not empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "72"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.ExcludedAsset.addresses
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 403f9bb8-080e-4dae-8bd3-71c54028cfad
    type: regular
    task:
      id: 403f9bb8-080e-4dae-8bd3-71c54028cfad
      version: -1
      name: nexpose-remove-site-excluded-asset
      description: Remove excluded assets from a site.
      script: '|||nexpose-remove-site-excluded-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      assets:
        simple: 8.8.8.8
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "73":
    id: "73"
    taskid: 61caecdb-d358-4199-8543-e78a5d783f16
    type: regular
    task:
      id: 61caecdb-d358-4199-8543-e78a5d783f16
      version: -1
      name: nexpose-get-assets
      description: Returns all assets for which you have access.
      script: Rapid7 Nexpose|||nexpose-get-assets
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "74":
    id: "74"
    taskid: 77ff99b2-91c4-4175-840f-afaf94ad466e
    type: regular
    task:
      id: 77ff99b2-91c4-4175-840f-afaf94ad466e
      version: -1
      name: nexpose-list-tag (by name)
      description: Return a list of tags.
      script: '|||nexpose-list-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      limit:
        simple: "1"
      name:
        simple: testplaybook
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "75":
    id: "75"
    taskid: 56da0395-cf72-4caf-8864-dee2b40a7019
    type: regular
    task:
      id: 56da0395-cf72-4caf-8864-dee2b40a7019
      version: -1
      name: nexpose-delete-tag if exists
      description: Delete a tag.
      script: '|||nexpose-delete-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    scriptarguments:
      id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 9820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 5300a54d-9401-492c-8801-ced8f44a2a8b
    type: condition
    task:
      id: 5300a54d-9401-492c-8801-ced8f44a2a8b
      version: -1
      name: check if exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "50"
      "yes":
      - "75"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: ${Nexpose.Tag.id}
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: a44db067-cbec-4abf-8856-5bf2da8f9bad
    type: regular
    task:
      id: a44db067-cbec-4abf-8856-5bf2da8f9bad
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 9995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 12110,
        "width": 605,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: fake_asset_ip
  value:
    simple: 192.0.2.0
  required: false
  description: IP to use when creating a new asset.
  playbookInputQuery: null
- key: asset_with_vulnerability_vulnerability_id
  value:
    simple: generic-tcp-timestamp
  required: false
  description: The vulnerability that exists in the asset that was set on 'asset_with_vulnerability_id'.
  playbookInputQuery: null
- key: vulenrability_id_to_except
  value:
    simple: 7-zip-cve-2008-6536
  required: false
  description: ID of a vulnerability to add an exception for.
  playbookInputQuery: null
outputs: []
