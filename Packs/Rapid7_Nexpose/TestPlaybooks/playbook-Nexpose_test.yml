id: nexpose_test
version: 6
vcShouldKeepItemLegacyProdMachine: false
name: Nexpose Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 21f34ae8-83b9-41e9-8305-8385be01bec9
    type: start
    task:
      id: 21f34ae8-83b9-41e9-8305-8385be01bec9
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "62"
      - "1"
      - "65"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 3c63e190-2222-4da3-8cdb-f267ab132e4d
    type: regular
    task:
      id: 3c63e190-2222-4da3-8cdb-f267ab132e4d
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 8c4c53af-1c3c-48e0-8f32-8969af1f8b3a
    type: regular
    task:
      id: 8c4c53af-1c3c-48e0-8f32-8969af1f8b3a
      version: -1
      name: nexpose-create-asset
      description: Create a new asset.
      script: Rapid7 Nexpose|||nexpose-create-asset
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      date:
        complex:
          root: TimeNow
      ip:
        complex:
          root: inputs.fake_asset_ip
      site_id:
        complex:
          root: Nexpose.Site
          accessor: Id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 5a7e596c-f1dc-4b61-8772-9fb62d29995c
    type: regular
    task:
      id: 5a7e596c-f1dc-4b61-8772-9fb62d29995c
      version: -1
      name: nexpose-get-sites
      description: Retrieves accessible sites.
      script: Rapid7 Nexpose|||nexpose-get-sites
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: afed79a7-a35b-4040-8456-618246a47d5d
    type: regular
    task:
      id: afed79a7-a35b-4040-8456-618246a47d5d
      version: -1
      name: nexpose-search-assets
      description: Search all assets matching filters (with Returns all assets for
        which you have access that match the given search criteria.
      script: Rapid7 Nexpose|||nexpose-search-assets
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      limit:
        simple: "1"
      riskScoreHigherThan:
        simple: "10000"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 490a4505-18db-4cf0-8b42-41e34466bb6e
    type: regular
    task:
      id: 490a4505-18db-4cf0-8b42-41e34466bb6e
      version: -1
      name: nexpose-get-asset
      description: Returns the specified asset.
      script: Rapid7 Nexpose|||nexpose-get-asset
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      id:
        complex:
          root: Nexpose.Asset
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 71bf1750-f683-4453-833c-268b051817b6
    type: regular
    task:
      id: 71bf1750-f683-4453-833c-268b051817b6
      version: -1
      name: nexpose-delete-asset
      description: Delete an asset.
      script: Rapid7 Nexpose|||nexpose-delete-asset
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      id:
        complex:
          root: Nexpose.Asset
          accessor: AssetId
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 9433f299-a5a3-4a5d-8ae0-c308a686599b
    type: regular
    task:
      id: 9433f299-a5a3-4a5d-8ae0-c308a686599b
      version: -1
      name: nexpose-get-scan
      description: Get a specific scan.
      script: Rapid7 Nexpose|||nexpose-get-scan
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      id:
        complex:
          root: Nexpose.Scan
          accessor: Id
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: f401e0d0-67fc-4a51-89e4-113d5b91f902
    type: regular
    task:
      id: f401e0d0-67fc-4a51-89e4-113d5b91f902
      version: -1
      name: nexpose-create-scan-report
      description: Generates a new report for a specified scan.
      script: Rapid7 Nexpose|||nexpose-create-scan-report
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      scan:
        complex:
          root: Nexpose.Scan
          accessor: Id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: eb7caf24-5aae-49a2-8673-7dc62540c0a0
    type: regular
    task:
      id: eb7caf24-5aae-49a2-8673-7dc62540c0a0
      version: -1
      name: nexpose-create-assets-report
      description: Generates a new report on given assets according to a template
        and arguments.
      script: Rapid7 Nexpose|||nexpose-create-assets-report
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      assets:
        complex:
          root: Nexpose.Asset
          accessor: AssetId
      download_immediately:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 6ff68045-9364-47a0-8ea6-4ea3f5b37286
    type: regular
    task:
      id: 6ff68045-9364-47a0-8ea6-4ea3f5b37286
      version: -1
      name: nexpose-create-sites-report
      description: Generates a new report on given sites according to a template and
        arguments.
      script: Rapid7 Nexpose|||nexpose-create-sites-report
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      sites:
        complex:
          root: Nexpose.Site
          accessor: Id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: d5f2d485-548d-4ec6-85c3-35b54441f3eb
    type: regular
    task:
      id: d5f2d485-548d-4ec6-85c3-35b54441f3eb
      version: -1
      name: nexpose-get-assets
      description: Returns all assets for which you have access.
      script: Rapid7 Nexpose|||nexpose-get-assets
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: feac6620-93cd-43f5-84a6-111a6b232669
    type: regular
    task:
      id: feac6620-93cd-43f5-84a6-111a6b232669
      version: -1
      name: nexpose-create-vulnerability-exception
      description: Create a new vulnerability exception.
      script: Rapid7 Nexpose|||nexpose-create-vulnerability-exception
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      reason:
        simple: Acceptable Use
      scope_id:
        complex:
          root: Nexpose.Asset
          accessor: id
      scope_type:
        simple: Asset
      state:
        simple: Under Review
      vulnerability_id:
        complex:
          root: inputs.vulenrability_id_to_except
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 1efbccc6-6f7a-4e9f-8c9c-250d4fb3bdf0
    type: regular
    task:
      id: 1efbccc6-6f7a-4e9f-8c9c-250d4fb3bdf0
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 26366527-4dc0-4e7b-8397-2e9f7488d508
    type: regular
    task:
      id: 26366527-4dc0-4e7b-8397-2e9f7488d508
      version: -1
      name: nexpose-delete-vulnerability-exception
      description: Delete a vulnerability exception.
      script: Rapid7 Nexpose|||nexpose-delete-vulnerability-exception
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      id:
        complex:
          root: Nexpose.VulnerabilityException
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: abc38d1c-dd5c-44dc-8b63-d1fdc8ebd432
    type: regular
    task:
      id: abc38d1c-dd5c-44dc-8b63-d1fdc8ebd432
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 547de31a-8134-456c-8cc1-a3dacea25b2b
    type: regular
    task:
      id: 547de31a-8134-456c-8cc1-a3dacea25b2b
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: 590ff980-1f5e-4670-882f-07ae739932fa
    type: regular
    task:
      id: 590ff980-1f5e-4670-882f-07ae739932fa
      version: -1
      name: nexpose-create-shared-credential
      description: 'Create a new shared credential. For detailed explanation of all
        parameters of this command, please see: https://help.rapid7.com/insightvm/en-us/api/index.html#operation/createSharedCredential'
      script: Rapid7 Nexpose|||nexpose-create-shared-credential
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      name:
        simple: Test-Credential
      password:
        simple: test
      service:
        simple: FTP
      site_assignment:
        simple: Specific-Sites
      sites:
        complex:
          root: Nexpose.Site
          accessor: Id
      username:
        simple: test
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: a3113c47-f5d9-423e-8e30-563212e2b840
    type: regular
    task:
      id: a3113c47-f5d9-423e-8e30-563212e2b840
      version: -1
      name: nexpose-list-shared-credential (specific ID)
      description: Retrieve information about all or a specific shared credential.
      script: Rapid7 Nexpose|||nexpose-list-shared-credential
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      id:
        complex:
          root: Nexpose.SharedCredential
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: f7df0411-3be0-47c8-839e-081540875d72
    type: regular
    task:
      id: f7df0411-3be0-47c8-839e-081540875d72
      version: -1
      name: nexpose-delete-shared-credential
      description: |-
        Beta Command

         Delete a shared credential.
      script: Rapid7 Nexpose|||nexpose-delete-shared-credential
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      id:
        complex:
          root: Nexpose.SharedCredential
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: f034e5c7-0ad6-4cd4-8844-56d308b83758
    type: regular
    task:
      id: f034e5c7-0ad6-4cd4-8844-56d308b83758
      version: -1
      name: nexpose-get-asset-vulnerability
      description: Returns details and possible remediations for an asset's vulnerability.
      script: Rapid7 Nexpose|||nexpose-get-asset-vulnerability
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      id:
        complex:
          root: inputs.asset_with_vulnerability_asset_id
      vulnerabilityId:
        complex:
          root: inputs.asset_with_vulnerability_vulnerability_id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 9ae95c2b-86e4-47d7-805e-bdd178df0720
    type: regular
    task:
      id: 9ae95c2b-86e4-47d7-805e-bdd178df0720
      version: -1
      name: nexpose-list-vulnerability (specific ID)
      description: Retrieve information about all or a specific vulnerability.
      script: Rapid7 Nexpose|||nexpose-list-vulnerability
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      id:
        complex:
          root: Nexpose.Asset.Vulnerability
          accessor: Id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 122722dc-9c70-47ab-82ed-503e85073a5d
    type: regular
    task:
      id: 122722dc-9c70-47ab-82ed-503e85073a5d
      version: -1
      name: nexpose-update-shared-credential
      description: Update an existing shared credential.
      script: Rapid7 Nexpose|||nexpose-update-shared-credential
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      id:
        complex:
          root: Nexpose.SharedCredential
          accessor: id
      name:
        simple: Test Credential
      password:
        simple: New Password
      service:
        simple: FTP
      site_assignment:
        simple: All-Sites
      username:
        simple: New Username
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: a50a6096-157f-4154-80b1-b31f15f0e373
    type: regular
    task:
      id: a50a6096-157f-4154-80b1-b31f15f0e373
      version: -1
      name: nexpose-update-vulnerability-exception-expiration
      description: Update an existing vulnerability exception.
      script: Rapid7 Nexpose|||nexpose-update-vulnerability-exception-expiration
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      expiration:
        complex:
          root: TimeNow
      id:
        complex:
          root: Nexpose.VulnerabilityException
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: ff8e092b-851a-45ad-8e07-e83f8599c6ca
    type: regular
    task:
      id: ff8e092b-851a-45ad-8e07-e83f8599c6ca
      version: -1
      name: nexpose-update-vulnerability-exception-status
      description: Update an existing vulnerability exception.
      script: Rapid7 Nexpose|||nexpose-update-vulnerability-exception-status
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      id:
        complex:
          root: Nexpose.VulnerabilityException
          accessor: id
      status:
        simple: Reject
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: affd3545-1187-4abb-85c8-ae0701bfe363
    type: regular
    task:
      id: affd3545-1187-4abb-85c8-ae0701bfe363
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 2448cb7d-11e7-4d50-8b52-2f198c4af102
    type: regular
    task:
      id: 2448cb7d-11e7-4d50-8b52-2f198c4af102
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 37f3bf36-4c2e-44bf-85ef-9874b74207cd
    type: regular
    task:
      id: 37f3bf36-4c2e-44bf-85ef-9874b74207cd
      version: -1
      name: nexpose-download-report
      description: Returns the generated report.
      script: Rapid7 Nexpose|||nexpose-download-report
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      instance_id:
        complex:
          root: Nexpose.Report
          accessor: InstanceID
      report_id:
        complex:
          root: Nexpose.Report
          accessor: ID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 961d1e24-c528-4b50-87bc-5540f4386b86
    type: title
    task:
      id: 961d1e24-c528-4b50-87bc-5540f4386b86
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 7545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: a1085f64-5f3e-4551-8e18-14423cc82e73
    type: regular
    task:
      id: a1085f64-5f3e-4551-8e18-14423cc82e73
      version: -1
      name: nexpose-get-asset-tags
      description: Returns the specified tags for an asset.
      script: Rapid7 Nexpose|||nexpose-get-asset-tags
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      asset_id:
        complex:
          root: Nexpose.Asset
          accessor: id
      id:
        complex:
          root: Nexpose.Asset
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: fcfd5383-5cec-4308-81f2-0b3636f33cc9
    type: regular
    task:
      id: fcfd5383-5cec-4308-81f2-0b3636f33cc9
      version: -1
      name: nexpose-get-sites
      description: Retrieves accessible sites.
      script: Rapid7 Nexpose|||nexpose-get-sites
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: d6ed4506-cea2-42ab-89ff-e0e6bc235ac0
    type: regular
    task:
      id: d6ed4506-cea2-42ab-89ff-e0e6bc235ac0
      version: -1
      name: nexpose-get-scans
      description: Return a list of scans. Returns only active scans by default (active=true).
      script: Rapid7 Nexpose|||nexpose-get-scans
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      active:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: aed4a7ba-c1af-4acb-8c8f-5e07c5b80e1c
    type: regular
    task:
      id: aed4a7ba-c1af-4acb-8c8f-5e07c5b80e1c
      version: -1
      name: nexpose-get-sites
      description: Retrieves accessible sites.
      script: Rapid7 Nexpose|||nexpose-get-sites
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 72b70e9a-cc19-4bcc-87c2-db47b5e9d5c5
    type: regular
    task:
      id: 72b70e9a-cc19-4bcc-87c2-db47b5e9d5c5
      version: -1
      name: nexpose-list-shared-credential
      description: Retrieve information about all or a specific shared credential.
      script: Rapid7 Nexpose|||nexpose-list-shared-credential
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "25"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 697492e4-748b-4518-8e25-a11423dbe5ec
    type: regular
    task:
      id: 697492e4-748b-4518-8e25-a11423dbe5ec
      version: -1
      name: nexpose-list-vulnerability
      description: Retrieve information about all or a specific vulnerability.
      script: Rapid7 Nexpose|||nexpose-list-vulnerability
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 627f341a-e2f2-4258-89b8-97b83daf4516
    type: condition
    task:
      id: 627f341a-e2f2-4258-89b8-97b83daf4516
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.Site.Id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: f17bcc31-0900-4161-80a0-e5785f9856bc
    type: condition
    task:
      id: f17bcc31-0900-4161-80a0-e5785f9856bc
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.Site.Id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 8f357618-95d0-4d09-8ee5-aac8056b8e49
    type: condition
    task:
      id: 8f357618-95d0-4d09-8ee5-aac8056b8e49
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.Site.Id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: b0853618-4983-4acd-8e61-413e5667cf1e
    type: regular
    task:
      id: b0853618-4983-4acd-8e61-413e5667cf1e
      version: -1
      name: GetTime
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      dateFormat:
        simple: ISO
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: cdd4d254-4332-4d0e-89dd-343c05f96e28
    type: regular
    task:
      id: cdd4d254-4332-4d0e-89dd-343c05f96e28
      version: -1
      name: GetTime (+1 year)
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      dateFormat:
        simple: ISO
      yearsAgo:
        simple: "-1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: 495d6dea-6c76-44b4-8643-5ec97d9d3760
    type: regular
    task:
      id: 495d6dea-6c76-44b4-8643-5ec97d9d3760
      version: -1
      name: nexpose-list-vulnerability-exceptions
      description: Retrieve information about scan schedules for a specific site or
        a specific scan schedule.
      script: Rapid7 Nexpose|||nexpose-list-vulnerability-exceptions
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      limit:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 5117b351-6c0e-4948-8ac2-71fee7107935
    type: regular
    task:
      id: 5117b351-6c0e-4948-8ac2-71fee7107935
      version: -1
      name: nexpose-delete-vulnerability-exception
      description: Delete a vulnerability exception.
      script: Rapid7 Nexpose|||nexpose-delete-vulnerability-exception
      type: regular
      iscommand: true
      brand: Rapid7 Nexpose
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      id:
        complex:
          root: Nexpose.VulnerabilityException
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: Nexpose.VulnerabilityException.scope.vulnerability
                iscontext: true
              right:
                value:
                  simple: inputs.vulenrability_id_to_except
                iscontext: true
          accessor: id
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 84a259ec-401f-4621-84b1-745321e6c0fa
    type: condition
    task:
      id: 84a259ec-401f-4621-84b1-745321e6c0fa
      version: -1
      name: If Vulnerability Already Has An Exception
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "49"
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: in
          left:
            value:
              simple: inputs.vulenrability_id_to_except
            iscontext: true
          right:
            value:
              complex:
                root: Nexpose.VulnerabilityException.scope
                accessor: vulnerability
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 2b2b2c03-865f-4093-83a5-14ecd4974003
    type: regular
    task:
      id: 2b2b2c03-865f-4093-83a5-14ecd4974003
      version: -1
      name: DeleteContext (Nexpose.VulnerabilityException)
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      key:
        simple: Nexpose.VulnerabilityException
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 69183128-ea51-4a20-8965-5f3f6daa0c0d
    type: regular
    task:
      id: 69183128-ea51-4a20-8965-5f3f6daa0c0d
      version: -1
      name: nexpose-create-tag
      description: Create a tag.
      script: '|||nexpose-create-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      color:
        simple: Green
      ip_address_is:
        simple: 1.1.1.1
      name:
        simple: abc123514
      type:
        simple: Custom
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 3084f5dc-8d41-47e5-83c6-108d0e670769
    type: regular
    task:
      id: 3084f5dc-8d41-47e5-83c6-108d0e670769
      version: -1
      name: nexpose-delete-tag
      description: Delete a tag.
      script: '|||nexpose-delete-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: ac3459cd-48c8-4dfc-89f3-4d50e77ca245
    type: regular
    task:
      id: ac3459cd-48c8-4dfc-89f3-4d50e77ca245
      version: -1
      name: Nexpose.update-tag-search-carteria
      description: Update tag search criteria.
      script: '|||nexpose-update-tag-search-criteria'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      risk_score_higher_than:
        simple: "8000"
      tag_id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 3cac4b18-8b96-420d-890f-ae551967d653
    type: condition
    task:
      id: 3cac4b18-8b96-420d-890f-ae551967d653
      version: -1
      name: check tag search filters
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: Nexpose.Tag.searchCriteria.filters.field
            iscontext: true
          right:
            value:
              simple: ip-address
      - - operator: isEqualString
          left:
            value:
              simple: Nexpose.Tag.searchCriteria.filters.field
            iscontext: true
          right:
            value:
              simple: risk-score
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 759de5d1-cfe5-4c16-8649-1b466568070f
    type: regular
    task:
      id: 759de5d1-cfe5-4c16-8649-1b466568070f
      version: -1
      name: nexpose-list-tag
      description: Return a list of tags.
      script: '|||nexpose-list-tag'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 79a5087f-2f1c-4243-8603-d308ef5fe796
    type: regular
    task:
      id: 79a5087f-2f1c-4243-8603-d308ef5fe796
      version: -1
      name: nexpose-list-tag-asset-group
      description: Return a list of asset groups for a tag.
      script: '|||nexpose-list-tag-asset-group'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      tag_id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: 365dcdd0-45de-437e-8044-a1923fe7e988
    type: regular
    task:
      id: 365dcdd0-45de-437e-8044-a1923fe7e988
      version: -1
      name: nexpose-list-tag-asset
      description: Return a list of assets for a tag.
      script: '|||nexpose-list-tag-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      tag_id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 78748328-5c62-4e3a-8cdc-3f0c314e8173
    type: regular
    task:
      id: 78748328-5c62-4e3a-8cdc-3f0c314e8173
      version: -1
      name: nexpose-add-tag-asset
      description: Add an existing asset to an existing tag.
      script: '|||nexpose-add-tag-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      asset_id:
        simple: ${Nexpose.Asset.AssetId}
      tag_id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 23815cfc-b3e1-42c2-8c21-a2899cadb839
    type: regular
    task:
      id: 23815cfc-b3e1-42c2-8c21-a2899cadb839
      version: -1
      name: nexpose-get-assets
      description: Returns all assets for which you have access.
      script: '|||nexpose-get-assets'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: f94a60de-3592-42f5-8163-a4ba8cf2f2b9
    type: condition
    task:
      id: f94a60de-3592-42f5-8163-a4ba8cf2f2b9
      version: -1
      name: check tag assets not empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "60"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.TagAsset
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: d97e2e54-c217-4ec4-8021-72f68db66418
    type: regular
    task:
      id: d97e2e54-c217-4ec4-8021-72f68db66418
      version: -1
      name: nexpose-remove-tag-asset
      description: Remove an asset from a tag. Please note that the asset must be
        added through the asset or tag. If the asset is added using a site, asset
        group, or search criteria, this action will not remove the asset from the
        tag.
      script: '|||nexpose-remove-tag-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      asset_id:
        simple: ${Nexpose.Asset.AssetId}
      tag_id:
        simple: ${Nexpose.Tag.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: c5a1c26b-895a-45aa-8d79-3ea8e8c6d799
    type: regular
    task:
      id: c5a1c26b-895a-45aa-8d79-3ea8e8c6d799
      version: -1
      name: nexpose-add-site-included-asset
      description: Add included assets to a site.
      script: '|||nexpose-add-site-included-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      assets:
        simple: 8.8.8.8
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 6145
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 3a1d8a4e-255b-4287-8751-a9c3069405d4
    type: regular
    task:
      id: 3a1d8a4e-255b-4287-8751-a9c3069405d4
      version: -1
      name: nexpose-get-sites
      description: Retrieves accessible sites.
      script: '|||nexpose-get-sites'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      limit:
        simple: "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 5970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: d5460e73-6b27-4821-8c61-db8a276022ab
    type: regular
    task:
      id: d5460e73-6b27-4821-8c61-db8a276022ab
      version: -1
      name: nexpose-list-site-included-asset
      description: Return a list of included assets for a site.
      script: '|||nexpose-list-site-included-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "68"
    scriptarguments:
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 6320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 57a60edd-9575-4cfa-8c30-bbc5bf0ec14e
    type: regular
    task:
      id: 57a60edd-9575-4cfa-8c30-bbc5bf0ec14e
      version: -1
      name: DeleteContext
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 36f206b7-4fac-4f75-8fa8-fbe923056335
    type: regular
    task:
      id: 36f206b7-4fac-4f75-8fa8-fbe923056335
      version: -1
      name: nexpose-remove-site-included-asset
      description: Remove included assets from a site.
      script: '|||nexpose-remove-site-included-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      assets:
        simple: 8.8.8.8
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 6670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: d6c975f7-bc2a-4964-82e8-3e3d568e62e4
    type: condition
    task:
      id: d6c975f7-bc2a-4964-82e8-3e3d568e62e4
      version: -1
      name: check site included assets not empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.IncludedAsset.addresses
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 6495
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 582e59b5-8feb-4d27-881a-b9d37b630f22
    type: regular
    task:
      id: 582e59b5-8feb-4d27-881a-b9d37b630f22
      version: -1
      name: nexpose-add-site-excluded-asset
      description: Add excluded assets to a site.
      script: '|||nexpose-add-site-excluded-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      assets:
        simple: 8.8.8.8
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 6845
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 431625b8-d42d-45b6-814e-710e5303e091
    type: regular
    task:
      id: 431625b8-d42d-45b6-814e-710e5303e091
      version: -1
      name: nexpose-list-site-excluded-asset
      description: Return a list of excluded assets for a site.
      script: '|||nexpose-list-site-excluded-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 7020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: bdb570a4-741f-44a1-874b-e0ba50baf808
    type: condition
    task:
      id: bdb570a4-741f-44a1-874b-e0ba50baf808
      version: -1
      name: check site excluded assets not empty
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "72"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Nexpose.ExcludedAsset.addresses
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 7195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: ea2c142a-6f0d-4873-8ce6-2f06b8452b3b
    type: regular
    task:
      id: ea2c142a-6f0d-4873-8ce6-2f06b8452b3b
      version: -1
      name: nexpose-remove-site-excluded-asset
      description: Remove excluded assets from a site.
      script: '|||nexpose-remove-site-excluded-asset'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      assets:
        simple: 8.8.8.8
      site_id:
        simple: ${Nexpose.Site.Id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1022.5,
          "y": 7370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 7560,
        "width": 1352.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs:
- key: fake_asset_ip
  value:
    simple: 192.0.2.0
  required: false
  description: IP to use when creating a new asset.
  playbookInputQuery: null
- key: asset_with_vulnerability_asset_id
  value:
    simple: "17"
  required: false
  description: ID of an asset with a specific vulnerability to check.
  playbookInputQuery: null
- key: asset_with_vulnerability_vulnerability_id
  value:
    simple: generic-tcp-timestamp
  required: false
  description: The vulnerability that exists in the asset that was set on 'asset_with_vulnerability_id'.
  playbookInputQuery: null
- key: vulenrability_id_to_except
  value:
    simple: 7-zip-cve-2008-6536
  required: false
  description: ID of a vulnerability to add an exception for.
  playbookInputQuery: null
outputs: []
